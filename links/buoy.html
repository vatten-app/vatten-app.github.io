---
title: Vatten Buoys
description: Uncover Nearby Hidden Gems on the Vatten
image: ../images/vattenBuoyWeb.jpg

sitemap: false
downloadLnk: https://apps.apple.com/ca/app/vatten/id6478919573
---

<div class="cta button alt"><a href="{{ page.downloadLnk }}" class="appleStoreLogo">  </a></div>
<h2 id="buoy-human-id"></h2>
<div id="buoy-note-id" class="buoyNote"></div>
<img id="mapbox-img" \>
<div class="button alt">
    <button id="app-open">
      open this link
    </button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.9.0/showdown.min.js"></script>

<script>

  function setMapURL(imgId, long, lat) {
    const elem = document.getElementById(imgId);
    const apiKey = "pk.eyJ1IjoidmF0dGVuLWFwcCIsImEiOiJjbHg4MjJ0aHgyOW42MmlxMW53bWF0YWxjIn0.L52v-2bR-_-aJ8VoGY1tqA"
    elem.src = `https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v12/static/pin-l-v+000(${long},${lat})/${long},${lat},15/1280x791@2x?access_token=${apiKey}`
  }

  function httpURLtoAppLink(url, isDebugging) {
    var schema = "com.realmtai.Blackbread";
    if (isDebugging) {
      schema = "com.realmtai.Blackbread.dev";
    }
    return url
      .replace("https", schema)
      .replace("http", schema)
  }

  function setOpenAppURL(elemid, url, isDebugging) {
    const openAppButton = document.getElementById(elemid);
    openAppButton.addEventListener("click", async () => {
      try {
        await navigator.share({ title: "Open This Link in the Vatten App", url: url });
        console.log("Data was shared successfully");
      } catch (err) {
        console.error("Share failed:", err.message);
      }
    });
  }

  function setNote(buoyid, buoyNoteMD) {
    const buoyName = document.getElementById("buoy-human-id");
    buoyName.innerHTML = buoyid
    var converter = new showdown.Converter(),
        notetext  = buoyNoteMD,
        notehtml  = converter.makeHtml(notetext);
    const buoyNote = document.getElementById("buoy-note-id");
    buoyNote.innerHTML = notehtml;
  }

  function setError(errorMessage) {
    const buoyName = document.getElementById("buoy-human-id");
    buoyName.innerHTML = errorMessage;
  }

  function dataAssert(note) {
    return note.date && note.hid && note.lat && note.long && note.note
  }

  function load() {
    const params = new URLSearchParams(document.location.search);
    const urlLoc = document.URL;

    const dat = params.get("dat");
    const isDebugging = params.get("d");
    const decodedData = window.atob(dat);
    const transientData = JSON.parse(decodedData);

    if (dataAssert(transientData)) {
      setOpenAppURL("app-open", urlLoc, isDebugging)
      setMapURL("mapbox-img", transientData.long, transientData.lat);
      addEventListener("DOMContentLoaded", (event) => {
        setNote(transientData.hid, transientData.note);
      });
    } else {
      setError("Looks like something went wrong :/");
    }
  }

  load();
</script>


